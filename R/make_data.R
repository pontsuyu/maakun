# 必要なデータの作成
library(pitchRx2)
library(tidyverse)
library(DBI)
library(animation)
db <- src_sqlite("maakun.sqlite3", create = T)
# 2014-17のヤンキースの試合IDを取得
nya <- game_ids %>% str_subset("201[4-7].*nya.*")
# レギュラーシーズン以外(2016-17)の試合ID
not_regular_season <- 
  c("gid_2016_03_02_detmlb_nyamlb_1",
    "gid_2016_03_03_phimlb_nyamlb_1",
    "gid_2016_03_04_nyamlb_detmlb_1",
    "gid_2016_03_05_bosmlb_nyamlb_1",
    "gid_2016_03_06_nyamlb_phimlb_1",
    "gid_2016_03_07_houmlb_nyamlb_1",
    "gid_2016_03_08_nyamlb_miamlb_1",
    "gid_2016_03_09_nyamlb_nynmlb_1",
    "gid_2016_03_10_nyamlb_balmlb_1",
    "gid_2016_03_10_tormlb_nyamlb_1",
    "gid_2016_03_11_balmlb_nyamlb_1",
    "gid_2016_03_12_nyamlb_tbamlb_1",
    "gid_2016_03_13_phimlb_nyamlb_1",
    "gid_2016_03_15_nyamlb_bosmlb_1",
    "gid_2016_03_16_tormlb_nyamlb_1",
    "gid_2016_03_17_nyamlb_pitmlb_1",
    "gid_2016_03_18_balmlb_nyamlb_1",
    "gid_2016_03_19_atlmlb_nyamlb_1",
    "gid_2016_03_20_nyamlb_minmlb_1",
    "gid_2016_03_22_nynmlb_nyamlb_1",
    "gid_2016_03_23_nyamlb_wasmlb_1",
    "gid_2016_03_24_tbamlb_nyamlb_1",
    "gid_2016_03_25_nyamlb_balmlb_1",
    "gid_2016_03_26_nyamlb_tormlb_1",
    "gid_2016_03_27_minmlb_nyamlb_1",
    "gid_2016_03_28_detmlb_nyamlb_1",
    "gid_2016_03_29_nyamlb_phimlb_1",
    "gid_2016_03_29_pitmlb_nyamlb_1",
    "gid_2016_03_30_nyamlb_atlmlb_1",
    "gid_2016_03_31_nyamlb_detmlb_1",
    "gid_2016_03_31_slnmlb_nyamlb_1",
    "gid_2016_04_01_nyamlb_miamlb_1",
    "gid_2016_04_02_nyamlb_miamlb_1",
    "gid_2016_04_04_houmlb_nyamlb_1",
    "gid_2017_02_24_phimlb_nyamlb_1",
    "gid_2017_02_25_nyamlb_phimlb_1",
    "gid_2017_02_26_tormlb_nyamlb_1",
    "gid_2017_02_27_nyamlb_balmlb_1",
    "gid_2017_02_28_detmlb_nyamlb_1",
    "gid_2017_02_28_nyamlb_bosmlb_1",
    "gid_2017_03_01_atlmlb_nyamlb_1",
    "gid_2017_03_02_balmlb_nyamlb_1",
    "gid_2017_03_03_nyamlb_tormlb_1",
    "gid_2017_03_04_nyamlb_detmlb_1",
    "gid_2017_03_05_pitmlb_nyamlb_1",
    "gid_2017_03_06_nyamlb_pitmlb_1",
    "gid_2017_03_07_tbamlb_nyamlb_1",
    "gid_2017_03_08_canint_nyamlb_1",
    "gid_2017_03_09_nyamlb_atlmlb_1",
    "gid_2017_03_10_nyamlb_phimlb_1",
    "gid_2017_03_11_detmlb_nyamlb_1",
    "gid_2017_03_12_atlmlb_nyamlb_1",
    "gid_2017_03_14_nyamlb_tbamlb_1",
    "gid_2017_03_15_phimlb_nyamlb_1",
    "gid_2017_03_16_nyamlb_tormlb_1",
    "gid_2017_03_17_nyamlb_detmlb_1",
    "gid_2017_03_18_balmlb_nyamlb_1",
    "gid_2017_03_19_nyamlb_houmlb_1",
    "gid_2017_03_20_nyamlb_wasmlb_1",
    "gid_2017_03_21_bosmlb_nyamlb_1",
    "gid_2017_03_22_nyamlb_phimlb_1",
    "gid_2017_03_23_nyamlb_tbamlb_1",
    "gid_2017_03_24_phimlb_nyamlb_1",
    "gid_2017_03_25_tormlb_nyamlb_1",
    "gid_2017_03_26_tbamlb_nyamlb_1",
    "gid_2017_03_28_detmlb_nyamlb_1",
    "gid_2017_03_29_nyamlb_tormlb_1",
    "gid_2017_03_30_nyamlb_phimlb_1",
    "gid_2017_03_31_nyamlb_atlmlb_1",
    "gid_2017_10_03_minmlb_nyamlb_1",
    "gid_2017_10_05_nyamlb_clemlb_1",
    "gid_2017_10_06_nyamlb_clemlb_1",
    "gid_2017_10_08_clemlb_nyamlb_1",
    "gid_2017_10_09_clemlb_nyamlb_1",
    "gid_2017_10_11_nyamlb_clemlb_1",
    "gid_2017_10_13_nyamlb_houmlb_1",
    "gid_2017_10_14_nyamlb_houmlb_1",
    "gid_2017_10_16_houmlb_nyamlb_1",
    "gid_2017_10_17_houmlb_nyamlb_1",
    "gid_2017_10_18_houmlb_nyamlb_1",
    "gid_2017_10_20_nyamlb_houmlb_1",
    "gid_2017_10_21_nyamlb_houmlb_1")
#####
nya <- nya[!nya %in% not_regular_season]
suffix <- c("miniscoreboard.xml", "players.xml", "inning/inning_hit.xml")
scrape(game.ids = nya, connect = db$con, suffix = "inning/inning_all.xml")
db_list_tables(db$con)
 "action" "atbat" "pitch" "po" "runner"
